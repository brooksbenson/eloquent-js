!function(n){var t={};function e(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return n[o].call(s.exports,s,s.exports,e),s.l=!0,s.exports}e.m=n,e.c=t,e.d=function(n,t,o){e.o(n,t)||Object.defineProperty(n,t,{configurable:!1,enumerable:!0,get:o})},e.r=function(n){Object.defineProperty(n,"__esModule",{value:!0})},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=0)}([function(n,t,e){"use strict";e.r(t);const o=20;!function(n){let t=Object.create(null);function e(e){n.includes(e.key)&&(t[e.key]="keydown"==e.type,e.preventDefault())}window.addEventListener("keydown",e),window.addEventListener("keyup",e)}(["ArrowLeft","ArrowRight","ArrowUp"]);class s{constructor(n,t){this.pos=n,this.speed=t}get type(){return"player"}static create(n){return new s(n.plus(new p(0,-.5)),new p(0,0))}}s.prototype.size=new p(.8,1.5),s.prototype.update=function(n,t,e){let o=0;e.ArrowLeft&&(o-=7),e.ArrowRight&&(o+=7);let r=this.pos,i=r.plus(new p(o*n,0));t.level.touches(i,this.size,"wall")||(r=i);let l=this.speed.y+30*n,a=r.plus(new p(0,l*n));return t.level.touches(a,this.size,"wall")?l=e.ArrowUp&&l>0?-17:0:r=a,new s(r,new p(o,l))};class r{constructor(n,t,e){this.pos=n,this.speed=t,this.reset=e}get type(){return"lava"}static create(n,t){return"="==t?new r(n,new p(2,0)):"|"==t?new r(n,new p(0,2)):"v"==t?new r(n,new p(0,3),n):void 0}}r.prototype.size=new p(1,1),r.prototype.collide=function(n){return new State(n.level,n.actors,"lost")},r.prototype.update=function(n,t){let e=this.pos.plus(this.speed.times(n));return t.level.touches(e,this.size,"wall")?this.reset?new r(this.reset,this.speed,this.reset):new r(this.pos,this.speed.times(-1)):new r(e,this.speed,this.reset)};class i{constructor(n,t,e){this.pos=n,this.basePos=t,this.wobble=e}get type(){return"coin"}static create(n){let t=n.plus(new p(.2,.1));return new i(t,t,Math.random()*Math.PI*2)}}i.prototype.size=new p(.6,.6),i.prototype.collide=function(n){let t=n.actors.filter(n=>n!=this),e=n.status;return t.some(n=>"coin"==n.type)||(e="won"),new State(n.level,t,e)},i.prototype.update=function(n){let t=this.wobble+8*n,e=.07*Math.sin(t);return new i(this.basePos.plus(new p(0,e)),this.basePos,t)};const l={".":"empty","#":"wall","+":"lava","@":s,"=":r,"|":r,v:r,o:i};class a{constructor(n){const t=n.trim().split("\n").map(n=>[...n]);this.height=t.length,this.width=t[0].length,this.startActors=[],this.rows=t.map((n,t)=>n.map((n,e)=>{const o=l[n];return"string"==typeof o?o:(this.startActors.push(o.create(new p(e,t),n)),"empty")}))}}a.prototype.touches=function(n,t,e){let o=Math.floor(n.x),s=Math.ceil(n.x+t.x),r=Math.floor(n.y),i=Math.ceil(n.y+t.y);for(let n=r;n<i;n++)for(let t=o;t<s;t++){if((t<0||t>=this.width||n<0||n>=this.height?"wall":this.rows[n][t])==e)return!0}return!1};var c=a;class p{constructor(n,t){this.x=n,this.y=t}plus(n){return new p(this.x+n.x,this.y+n.y)}times(n){return new p(this.x*n,this.y*n)}}function u(n,t,...e){const o=document.createElement(n);for(let n of Object.keys(t))o.setAttribute(n,t[n]);for(let n of e)o.appendChild(n);return o}function h(n,t){let e=new t(document.body,n),o=State.start(n),s=1;return new Promise(n=>{!function(n){let t=null;requestAnimationFrame(function e(o){if(null!=t){let e=Math.min(o-t,100)/1e3;if(!1===n(e))return}t=o,requestAnimationFrame(e)})}(t=>(o=o.update(t,arrowKeys),e.syncState(o),"playing"==o.status||(s>0?(s-=t,!0):(e.clear(),n(o.status),!1))))})}class w{constructor(n,t){this.dom=u("div",{class:"game"},function(n){return u("table",{class:"background",style:`width: ${n.width*o}px`},...n.rows.map(n=>u("tr",{style:`height: ${o}px`},...n.map(n=>u("td",{class:n})))))}(t)),this.actorLayer=null,n.appendChild(this.dom)}clear(){this.dom.remove()}}w.prototype.syncState=function(n){this.actorLayer&&this.actorLayer.remove(),this.actorLayer=u("div",{},...n.actors.map(n=>{let t=u("div",{class:`actor ${n.type}`});return t.style.width=`${n.size.x*o}px`,t.style.height=`${n.size.y*o}px`,t.style.left=`${n.pos.x*o}px`,t.style.top=`${n.pos.y*o}px`,t})),this.dom.appendChild(this.actorLayer),this.dom.className="game "+n.status,this.scrollPlayerIntoView(n)},w.prototype.scrollPlayerIntoView=function(n){let t=this.dom.clientWidth,e=this.dom.clientHeight,s=t/3,r=this.dom.scrollLeft,i=r+t,l=this.dom.scrollTop,a=l+e,c=n.player,p=c.pos.plus(c.size.times(.5)).times(o);p.x<r+s?this.dom.scrollLeft=p.x-s:p.x>i-s&&(this.dom.scrollLeft=p.x+s-t),p.y<l+s?this.dom.scrollTop=p.y-s:p.y>a-s&&(this.dom.scrollTop=p.y+s-e)},async function(n,t){for(let e=0;e<n.length;)"won"==await h(new c(n[e]),t)&&e++;console.log("You've won!")}(["                                                    \n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n................................................................................\n..................................................................###...........\n...................................................##......##....##+##..........\n....................................o.o......##..................#+++#..........\n.................................................................##+##..........\n...................................#####..........................#v#...........\n............................................................................##..\n..##......................................o.o................................#..\n..#.....................o....................................................#..\n..#......................................#####.............................o.#..\n..#..........####.......o....................................................#..\n..#..@.......#..#................................................#####.......#..\n..############..###############...####################.....#######...#########..\n..............................#...#..................#.....#....................\n..............................#+++#..................#+++++#....................\n..............................#+++#..................#+++++#....................\n..............................#####..................#######....................\n................................................................................\n................................................................................\n","                                                                     \n................................................................................\n................................................................................\n....###############################.............................................\n...##.............................##########################################....\n...#.......................................................................##...\n...#....o...................................................................#...\n...#................................................=.......................#...\n...#.o........################...................o..o...........|........o..#...\n...#.........................#..............................................#...\n...#....o....................##########.....###################....##########...\n...#..................................#+++++#.................#....#............\n...###############....oo......=o.o.o..#######.###############.#....#............\n.....#...............o..o.............#.......#......#........#....#............\n.....#....................#############..######.####.#.########....########.....\n.....#.............########..............#...........#.#..................#.....\n.....#..........####......####...#####################.#..................#.....\n.....#........###............###.......................########....########.....\n.....#.......##................#########################......#....#............\n.....#.......#................................................#....#............\n.....###......................................................#....#............\n.......#...............o...........................................#............\n.......#...............................................o...........#............\n.......#########......###.....############.........................##...........\n.............#..................#........#####....#######.o.........########....\n.............#++++++++++++++++++#............#....#.....#..................#....\n.............#++++++++++++++++++#..........###....###...####.o.............#....\n.............####################..........#........#......#.....|.........#....\n...........................................#++++++++#......####............#....\n...........................................#++++++++#.........#........@...#....\n...........................................#++++++++#.........##############....\n...........................................##########...........................\n................................................................................\n","\n......................................#++#........................#######....................................#+#..\n......................................#++#.....................####.....####.................................#+#..\n......................................#++##########...........##...........##................................#+#..\n......................................##++++++++++##.........##.............##...............................#+#..\n.......................................##########++#.........#....................................o...o...o..#+#..\n................................................##+#.........#.....o...o....................................##+#..\n.................................................#+#.........#................................###############++#..\n.................................................#v#.........#.....#...#........................++++++++++++++##..\n.............................................................##..|...|...|..##............#####################...\n..............................................................##+++++++++++##............v........................\n...............................................................####+++++####......................................\n...............................................#.....#............#######........###.........###..................\n...............................................#.....#...........................#.#.........#.#..................\n...............................................#.....#.............................#.........#....................\n...............................................#.....#.............................##........#....................\n...............................................##....#.............................#.........#....................\n...............................................#.....#......o..o.....#...#.........#.........#....................\n...............#######........###...###........#.....#...............#...#.........#.........#....................\n..............##.....##.........#...#..........#.....#.....######....#...#...#########.......#....................\n.............##.......##........#.o.#..........#....##...............#...#...#...............#....................\n.....@.......#.........#........#...#..........#.....#...............#...#...#...............#....................\n....###......#.........#........#...#..........#.....#...............#...#####...######......#....................\n....#.#......#.........#.......##.o.##.........#.....#...............#.....o.....#.#.........#....................\n++++#.#++++++#.........#++++++##.....##++++++++##....#++++++++++.....#.....=.....#.#.........#....................\n++++#.#++++++#.........#+++++##.......##########.....#+++++++##+.....#############.##..o.o..##....................\n++++#.#++++++#.........#+++++#....o.................##++++++##.+....................##.....##.....................\n++++#.#++++++#.........#+++++#.....................##++++++##..+.....................#######......................\n++++#.#++++++#.........#+++++##.......##############++++++##...+..................................................\n++++#.#++++++#.........#++++++#########++++++++++++++++++##....+..................................................\n++++#.#++++++#.........#++++++++++++++++++++++++++++++++##.....+..................................................\n","\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n..............................................................................................................\n........................................o.....................................................................\n..............................................................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n........................................#.....................................................................\n.......................................###....................................................................\n.......................................#.#.................+++........+++..###................................\n.......................................#.#.................+#+........+#+.....................................\n.....................................###.###................#..........#......................................\n......................................#...#.................#...oooo...#.......###............................\n......................................#...#.................#..........#......#+++#...........................\n......................................#...#.................############.......###............................\n.....................................##...##......#...#......#................................................\n......................................#...#########...########..............#.#...............................\n......................................#...#...........#....................#+++#..............................\n......................................#...#...........#.....................###...............................\n.....................................##...##..........#.......................................................\n......................................#...#=.=.=.=....#............###........................................\n......................................#...#...........#...........#+++#.......................................\n......................................#...#....=.=.=.=#.....o......###.......###..............................\n.....................................##...##..........#.....................#+++#.............................\n..............................o...o...#...#...........#.....#................##v........###...................\n......................................#...#...........#..............#.................#+++#..................\n.............................###.###.###.###.....o.o..#++++++++++++++#...................v#...................\n.............................#.###.#.#.###.#..........#++++++++++++++#........................................\n.............................#.............#...#######################........................................\n.............................##...........##.........................................###......................\n..###.........................#.....#.....#.........................................#+++#................###..\n..#.#.........................#....###....#..........................................###.................#.#..\n..#...........................#....###....#######........................#####.............................#..\n..#...........................#...........#..............................#...#.............................#..\n..#...........................##..........#..............................#.#.#.............................#..\n..#.......................................#.......|####|....|####|.....###.###.............................#..\n..#................###.............o.o....#..............................#.........###.....................#..\n..#...............#####.......##..........#.............................###.......#+++#..........#.........#..\n..#...............o###o.......#....###....#.............................#.#........###..........###........#..\n..#................###........#############..#.oo.#....#.oo.#....#.oo..##.##....................###........#..\n..#......@..........#.........#...........#++#....#++++#....#++++#....##...##....................#.........#..\n..#############################...........#############################.....################################..\n..............................................................................................................\n..............................................................................................................\n","\n..................................................................................................###.#.......\n......................................................................................................#.......\n..................................................................................................#####.......\n..................................................................................................#...........\n..................................................................................................#.###.......\n..........................o.......................................................................#.#.#.......\n.............................................................................................o.o.o###.#.......\n...................###................................................................................#.......\n.......+..o..+................................................#####.#####.#####.#####.#####.#####.#####.......\n.......#.....#................................................#...#.#...#.#...#.#...#.#...#.#...#.#...........\n.......#=.o..#............#...................................###.#.###.#.###.#.###.#.###.#.###.#.#####.......\n.......#.....#..................................................#.#...#.#...#.#...#.#...#.#...#.#.....#.......\n.......+..o..+............o..................................####.#####.#####.#####.#####.#####.#######.......\n..............................................................................................................\n..........o..............###..............................##..................................................\n..............................................................................................................\n..............................................................................................................\n......................................................##......................................................\n...................###.........###............................................................................\n..............................................................................................................\n..........................o.....................................................#......#......................\n..........................................................##.....##...........................................\n.............###.........###.........###.................................#..................#.................\n..............................................................................................................\n.................................................................||...........................................\n..###########.................................................................................................\n..#.........#.o.#########.o.#########.o.##................................................#...................\n..#.........#...#.......#...#.......#...#.................||..................#.....#.........................\n..#..@......#####...o...#####...o...#####.....................................................................\n..#######.....................................#####.......##.....##.....###...................................\n........#=..................=................=#...#.....................###...................................\n........#######################################...#+++++++++++++++++++++###+++++++++++++++++++++++++++++++++++\n..................................................############################################################\n..............................................................................................................\n"],w)}]);